<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p></p>
<p>&lt;!doctype html&gt;</p>
<html><br><head><meta name="generator" content="Hexo 3.9.0"><br><base href="http://h5.hunlipic.com/geren_fensepiaoye/"><br><meta charset="utf-8"><br><title>关于我们</title><br><br><link href="css/menu.css" rel="stylesheet"><br><link href="http://cdn.bootcss.com/normalize/4.2.0/normalize.min.css" rel="stylesheet"><br></head><br><body><br><canvas id="sakura"></canvas><br><div class="btnbg"><br><div class="cs"><br><div class="htmleaf-container"><br><nav class="animenu"><br><button class="animenu__toggle"><br><span class="animenu__toggle__bar"></span><br><span class="animenu__toggle__bar"></span><br><span class="animenu__toggle__bar"></span><br></button><br><ul class="animenu__nav" style=" text-align:center"><br><li><br><a href="http://mjntutanota.github.io/" target="_blank" title="我们的小窝">我们的小窝</a><br></li><br><li style="border-right: 1px solid #444444; border-right: 0px;"><br><a href="mailto:mjn1234@tutanota.github.io" target="_blank" title="联系我吧">联系我吧</a><br></li><br></ul><br></nav><br></div><br><center><br><br><br><br><img src="http://i1.fuimg.com/691047/a33ba507111f7f26.jpg" id="logo"><br><br><br><br><hr><br><br><br><br><p style="font-size:30px;">我们的博客小窝<br><br><a href="http://mjntutanota.github.io/" class="btn-slide" target="_blank"> <span class="circle"><i class="fa fa-rocket"></i></span> <span class="title">我们的小窝</span> <span class="title-hover">进入小窝</span> </a><br><a href="http://wpa.qq.com/msgrd?v=3&uin=2963596377" class="btn-slide2" target="_blank"> <span class="circle2"><i class="fa fa-download"></i></span> <span class="title2">联系我吧</span> <span class="title-hover2">Contact QQ</span></a><br></p><p style="font-size:20px;">我喜欢看书，听音乐，冥想；喜欢吃茄子和土豆，喜欢火影，柯南和网王<br><br></p><p style="font-size:20px;">小猪喜欢吃水果捞，喜欢睡觉，喜欢看小说不说话<br><br><br><br><br><br><br><br><br><br><br><br><div style="position:absolute;top:90%;left:50px;height:10px;width:600px;color:#E91E63;"><br><audio autoplay="autoplay"><br><source src="http://t.hunlipic.com/?rzdx" type="audio/mpeg"><br><div style="display:none"><script type="text/javascript">var cnzz_protocol = ((“https:” == document.location.protocol) ? “ https://“ : “ http://“);document.write(unescape(“%3Cspan id=’cnzz_stat_icon_1256580097’%3E%3C/span%3E%3Cscript src=’” + cnzz_protocol + “s95.cnzz.com/z_stat.php%3Fid%3D1256580097%26show%3Dpic1’ type=’text/javascript’%3E%3C/script%3E”));</script></div><br><script type="text/javascript"><br>        document.getElementById(‘bgaudio’).play();<br></script><br></audio><br></div><br><br><script id="sakura_point_vsh" type="x-shader/x_vertex"><br>uniform mat4 uProjection;<br>uniform mat4 uModelview;<br>uniform vec3 uResolution;<br>uniform vec3 uOffset;<br>uniform vec3 uDOF;  //x:focus distance, y:focus radius, z:max radius<br>uniform vec3 uFade; //x:start distance, y:half distance, z:near fade start<br><br>attribute vec3 aPosition;<br>attribute vec3 aEuler;<br>attribute vec2 aMisc; //x:size, y:fade<br><br>varying vec3 pposition;<br>varying float psize;<br>varying float palpha;<br>varying float pdist;<br><br>//varying mat3 rotMat;<br>varying vec3 normX;<br>varying vec3 normY;<br>varying vec3 normZ;<br>varying vec3 normal;<br><br>varying float diffuse;<br>varying float specular;<br>varying float rstop;<br>varying float distancefade;<br><br>void main(void) {<br>    // Projection is based on vertical angle<br>    vec4 pos = uModelview <em> vec4(aPosition + uOffset, 1.0);<br>    gl_Position = uProjection </em> pos;<br>    gl_PointSize = aMisc.x <em> uProjection[1][1] / -pos.z </em> uResolution.y <em> 0.5;<br><br>    pposition = pos.xyz;<br>    psize = aMisc.x;<br>    pdist = length(pos.xyz);<br>    palpha = smoothstep(0.0, 1.0, (pdist - 0.1) / uFade.z);<br><br>    vec3 elrsn = sin(aEuler);<br>    vec3 elrcs = cos(aEuler);<br>    mat3 rotx = mat3(<br>        1.0, 0.0, 0.0,<br>        0.0, elrcs.x, elrsn.x,<br>        0.0, -elrsn.x, elrcs.x<br>    );<br>    mat3 roty = mat3(<br>        elrcs.y, 0.0, -elrsn.y,<br>        0.0, 1.0, 0.0,<br>        elrsn.y, 0.0, elrcs.y<br>    );<br>    mat3 rotz = mat3(<br>        elrcs.z, elrsn.z, 0.0,<br>        -elrsn.z, elrcs.z, 0.0,<br>        0.0, 0.0, 1.0<br>    );<br>    mat3 rotmat = rotx </em> roty <em> rotz;<br>    normal = rotmat[2];<br><br>    mat3 trrotm = mat3(<br>        rotmat[0][0], rotmat[1][0], rotmat[2][0],<br>        rotmat[0][1], rotmat[1][1], rotmat[2][1],<br>        rotmat[0][2], rotmat[1][2], rotmat[2][2]<br>    );<br>    normX = trrotm[0];<br>    normY = trrotm[1];<br>    normZ = trrotm[2];<br><br>    const vec3 lit = vec3(0.6917144638660746, 0.6917144638660746, -0.20751433915982237);<br><br>    float tmpdfs = dot(lit, normal);<br>    if(tmpdfs &lt; 0.0) {<br>        normal = -normal;<br>        tmpdfs = dot(lit, normal);<br>    }<br>    diffuse = 0.4 + tmpdfs;<br><br>    vec3 eyev = normalize(-pos.xyz);<br>    if(dot(eyev, normal) &gt; 0.0) {<br>        vec3 hv = normalize(eyev + lit);<br>        specular = pow(max(dot(hv, normal), 0.0), 20.0);<br>    }<br>    else {<br>        specular = 0.0;<br>    }<br><br>    rstop = clamp((abs(pdist - uDOF.x) - uDOF.y) / uDOF.z, 0.0, 1.0);<br>    rstop = pow(rstop, 0.5);<br>    //-0.69315 = ln(0.5)<br>    distancefade = min(1.0, exp((uFade.x - pdist) </em> 0.69315 / uFade.y));<br>}<br></script><br><script id="sakura_point_fsh" type="x-shader/x_fragment"><br>#ifdef GL_ES<br>//precision mediump float;<br>precision highp float;<br>#endif<br><br>uniform vec3 uDOF;  //x:focus distance, y:focus radius, z:max radius<br>uniform vec3 uFade; //x:start distance, y:half distance, z:near fade start<br><br>const vec3 fadeCol = vec3(0.08, 0.03, 0.06);<br><br>varying vec3 pposition;<br>varying float psize;<br>varying float palpha;<br>varying float pdist;<br><br>//varying mat3 rotMat;<br>varying vec3 normX;<br>varying vec3 normY;<br>varying vec3 normZ;<br>varying vec3 normal;<br><br>varying float diffuse;<br>varying float specular;<br>varying float rstop;<br>varying float distancefade;<br><br>float ellipse(vec2 p, vec2 o, vec2 r) {<br>    vec2 lp = (p - o) / r;<br>    return length(lp) - 1.0;<br>}<br><br>void main(void) {<br>    vec3 p = vec3(gl_PointCoord - vec2(0.5, 0.5), 0.0) <em> 2.0;<br>    vec3 d = vec3(0.0, 0.0, -1.0);<br>    float nd = normZ.z; //dot(-normZ, d);<br>    if(abs(nd) &lt; 0.0001) discard;<br><br>    float np = dot(normZ, p);<br>    vec3 tp = p + d </em> np / nd;<br>    vec2 coord = vec2(dot(normX, tp), dot(normY, tp));<br><br>    //angle = 15 degree<br>    const float flwrsn = 0.258819045102521;<br>    const float flwrcs = 0.965925826289068;<br>    mat2 flwrm = mat2(flwrcs, -flwrsn, flwrsn, flwrcs);<br>    vec2 flwrp = vec2(abs(coord.x), coord.y) <em> flwrm;<br><br>    float r;<br>    if(flwrp.x &lt; 0.0) {<br>        r = ellipse(flwrp, vec2(0.065, 0.024) </em> 0.5, vec2(0.36, 0.96) <em> 0.5);<br>    }<br>    else {<br>        r = ellipse(flwrp, vec2(0.065, 0.024) </em> 0.5, vec2(0.58, 0.96) <em> 0.5);<br>    }<br><br>    if(r &gt; rstop) discard;<br><br>    vec3 col = mix(vec3(1.0, 0.8, 0.75), vec3(1.0, 0.9, 0.87), r);<br>    float grady = mix(0.0, 1.0, pow(coord.y </em> 0.5 + 0.5, 0.35));<br>    col <em>= vec3(1.0, grady, grady);<br>    col </em>= mix(0.8, 1.0, pow(abs(coord.x), 0.3));<br>    col = col <em> diffuse + specular;<br><br>    col = mix(fadeCol, col, distancefade);<br><br>    float alpha = (rstop &gt; 0.001)? (0.5 - r / (rstop </em> 2.0)) : 1.0;<br>    alpha = smoothstep(0.0, 1.0, alpha) <em> palpha;<br><br>    gl_FragColor = vec4(col </em> 0.5, alpha);<br>}<br></script><br><br><script id="fx_common_vsh" type="x-shader/x_vertex"><br>uniform vec3 uResolution;<br>attribute vec2 aPosition;<br><br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br><br>void main(void) {<br>    gl_Position = vec4(aPosition, 0.0, 1.0);<br>    texCoord = aPosition.xy <em> 0.5 + vec2(0.5, 0.5);<br>    screenCoord = aPosition.xy </em> vec2(uResolution.z, 1.0);<br>}<br></script><br><script id="bg_fsh" type="x-shader/x_fragment"><br>#ifdef GL_ES<br>//precision mediump float;<br>precision highp float;<br>#endif<br><br>uniform vec2 uTimes;<br><br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br><br>void main(void) {<br>    vec3 col;<br>    float c;<br>    vec2 tmpv = texCoord <em> vec2(0.8, 1.0) - vec2(0.95, 1.0);<br>    c = exp(-pow(length(tmpv) </em> 1.8, 2.0));<br>    col = mix(vec3(0.02, 0.0, 0.03), vec3(0.96, 0.98, 1.0) <em> 1.5, c);<br>    gl_FragColor = vec4(col </em> 0.5, 1.0);<br>}<br></script><br><script id="fx_brightbuf_fsh" type="x-shader/x_fragment"><br>#ifdef GL_ES<br>//precision mediump float;<br>precision highp float;<br>#endif<br>uniform sampler2D uSrc;<br>uniform vec2 uDelta;<br><br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br><br>void main(void) {<br>    vec4 col = texture2D(uSrc, texCoord);<br>    gl_FragColor = vec4(col.rgb <em> 2.0 - vec3(0.5), 1.0);<br>}<br></script><br><script id="fx_dirblur_r4_fsh" type="x-shader/x_fragment"><br>#ifdef GL_ES<br>//precision mediump float;<br>precision highp float;<br>#endif<br>uniform sampler2D uSrc;<br>uniform vec2 uDelta;<br>uniform vec4 uBlurDir; //dir(x, y), stride(z, w)<br><br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br><br>void main(void) {<br>    vec4 col = texture2D(uSrc, texCoord);<br>    col = col + texture2D(uSrc, texCoord + uBlurDir.xy </em> uDelta);<br>    col = col + texture2D(uSrc, texCoord - uBlurDir.xy <em> uDelta);<br>    col = col + texture2D(uSrc, texCoord + (uBlurDir.xy + uBlurDir.zw) </em> uDelta);<br>    col = col + texture2D(uSrc, texCoord - (uBlurDir.xy + uBlurDir.zw) <em> uDelta);<br>    gl_FragColor = col / 5.0;<br>}<br></script><br><br><script id="fx_common_fsh" type="x-shader/x_fragment"><br>#ifdef GL_ES<br>//precision mediump float;<br>precision highp float;<br>#endif<br>uniform sampler2D uSrc;<br>uniform vec2 uDelta;<br><br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br><br>void main(void) {<br>    gl_FragColor = texture2D(uSrc, texCoord);<br>}<br></script><br><br><script id="pp_final_vsh" type="x-shader/x_vertex"><br>uniform vec3 uResolution;<br>attribute vec2 aPosition;<br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br>void main(void) {<br>    gl_Position = vec4(aPosition, 0.0, 1.0);<br>    texCoord = aPosition.xy </em> 0.5 + vec2(0.5, 0.5);<br>    screenCoord = aPosition.xy <em> vec2(uResolution.z, 1.0);<br>}<br></script><br><script id="pp_final_fsh" type="x-shader/x_fragment"><br>#ifdef GL_ES<br>//precision mediump float;<br>precision highp float;<br>#endif<br>uniform sampler2D uSrc;<br>uniform sampler2D uBloom;<br>uniform vec2 uDelta;<br>varying vec2 texCoord;<br>varying vec2 screenCoord;<br>void main(void) {<br>    vec4 srccol = texture2D(uSrc, texCoord) </em> 2.0;<br>    vec4 bloomcol = texture2D(uBloom, texCoord);<br>    vec4 col;<br>    col = srccol + bloomcol <em> (vec4(1.0) + srccol);<br>    col </em>= smoothstep(1.0, 0.0, pow(length((texCoord - vec2(0.5)) <em> 2.0), 1.2) </em> 0.5);<br>    col = pow(col, vec4(0.45454545454545)); //(1.0 / 2.2)<br><br>    gl_FragColor = vec4(col.rgb, 1.0);<br>    gl_FragColor.a = 1.0;<br>}<br></script><br></p></center></div></div></body><br><script><br>// Utilities<br>var Vector3 = {};<br>var Matrix44 = {};<br>Vector3.create = function(x, y, z) {<br>    return {‘x’:x, ‘y’:y, ‘z’:z};<br>};<br>Vector3.dot = function (v0, v1) {<br>    return v0.x <em> v1.x + v0.y </em> v1.y + v0.z <em> v1.z;<br>};<br>Vector3.cross = function (v, v0, v1) {<br>    v.x = v0.y </em> v1.z - v0.z <em> v1.y;<br>    v.y = v0.z </em> v1.x - v0.x <em> v1.z;<br>    v.z = v0.x </em> v1.y - v0.y <em> v1.x;<br>};<br>Vector3.normalize = function (v) {<br>    var l = v.x </em> v.x + v.y <em> v.y + v.z </em> v.z;<br>    if(l &gt; 0.00001) {<br>        l = 1.0 / Math.sqrt(l);<br>        v.x <em>= l;<br>        v.y </em>= l;<br>        v.z <em>= l;<br>    }<br>};<br>Vector3.arrayForm = function(v) {<br>    if(v.array) {<br>        v.array[0] = v.x;<br>        v.array[1] = v.y;<br>        v.array[2] = v.z;<br>    }<br>    else {<br>        v.array = new Float32Array([v.x, v.y, v.z]);<br>    }<br>    return v.array;<br>};<br>Matrix44.createIdentity = function () {<br>    return new Float32Array([1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]);<br>};<br>Matrix44.loadProjection = function (m, aspect, vdeg, near, far) {<br>    var h = near </em> Math.tan(vdeg <em> Math.PI / 180.0 </em> 0.5) <em> 2.0;<br>    var w = h </em> aspect;<br><br>    m[0] = 2.0 <em> near / w;<br>    m[1] = 0.0;<br>    m[2] = 0.0;<br>    m[3] = 0.0;<br><br>    m[4] = 0.0;<br>    m[5] = 2.0 </em> near / h;<br>    m[6] = 0.0;<br>    m[7] = 0.0;<br><br>    m[8] = 0.0;<br>    m[9] = 0.0;<br>    m[10] = -(far + near) / (far - near);<br>    m[11] = -1.0;<br><br>    m[12] = 0.0;<br>    m[13] = 0.0;<br>    m[14] = -2.0 <em> far </em> near / (far - near);<br>    m[15] = 0.0;<br>};<br>Matrix44.loadLookAt = function (m, vpos, vlook, vup) {<br>    var frontv = Vector3.create(vpos.x - vlook.x, vpos.y - vlook.y, vpos.z - vlook.z);<br>    Vector3.normalize(frontv);<br>    var sidev = Vector3.create(1.0, 0.0, 0.0);<br>    Vector3.cross(sidev, vup, frontv);<br>    Vector3.normalize(sidev);<br>    var topv = Vector3.create(1.0, 0.0, 0.0);<br>    Vector3.cross(topv, frontv, sidev);<br>    Vector3.normalize(topv);<br><br>    m[0] = sidev.x;<br>    m[1] = topv.x;<br>    m[2] = frontv.x;<br>    m[3] = 0.0;<br><br>    m[4] = sidev.y;<br>    m[5] = topv.y;<br>    m[6] = frontv.y;<br>    m[7] = 0.0;<br><br>    m[8] = sidev.z;<br>    m[9] = topv.z;<br>    m[10] = frontv.z;<br>    m[11] = 0.0;<br><br>    m[12] = -(vpos.x <em> m[0] + vpos.y </em> m[4] + vpos.z <em> m[8]);<br>    m[13] = -(vpos.x </em> m[1] + vpos.y <em> m[5] + vpos.z </em> m[9]);<br>    m[14] = -(vpos.x <em> m[2] + vpos.y </em> m[6] + vpos.z <em> m[10]);<br>    m[15] = 1.0;<br>};<br><br>//<br>var timeInfo = {<br>    ‘start’:0, ‘prev’:0, // Date<br>    ‘delta’:0, ‘elapsed’:0 // Number(sec)<br>};<br><br>//<br>var gl;<br>var renderSpec = {<br>    ‘width’:0,<br>    ‘height’:0,<br>    ‘aspect’:1,<br>    ‘array’:new Float32Array(3),<br>    ‘halfWidth’:0,<br>    ‘halfHeight’:0,<br>    ‘halfArray’:new Float32Array(3)<br>    // and some render targets. see setViewport()<br>};<br>renderSpec.setSize = function(w, h) {<br>    renderSpec.width = w;<br>    renderSpec.height = h;<br>    renderSpec.aspect = renderSpec.width / renderSpec.height;<br>    renderSpec.array[0] = renderSpec.width;<br>    renderSpec.array[1] = renderSpec.height;<br>    renderSpec.array[2] = renderSpec.aspect;<br><br>    renderSpec.halfWidth = Math.floor(w / 2);<br>    renderSpec.halfHeight = Math.floor(h / 2);<br>    renderSpec.halfArray[0] = renderSpec.halfWidth;<br>    renderSpec.halfArray[1] = renderSpec.halfHeight;<br>    renderSpec.halfArray[2] = renderSpec.halfWidth / renderSpec.halfHeight;<br>};<br><br>function deleteRenderTarget(rt) {<br>    gl.deleteFramebuffer(rt.frameBuffer);<br>    gl.deleteRenderbuffer(rt.renderBuffer);<br>    gl.deleteTexture(rt.texture);<br>}<br><br>function createRenderTarget(w, h) {<br>    var ret = {<br>        ‘width’:w,<br>        ‘height’:h,<br>        ‘sizeArray’:new Float32Array([w, h, w / h]),<br>        ‘dtxArray’:new Float32Array([1.0 / w, 1.0 / h])<br>    };<br>    ret.frameBuffer = gl.createFramebuffer();<br>    ret.renderBuffer = gl.createRenderbuffer();<br>    ret.texture = gl.createTexture();<br><br>    gl.bindTexture(gl.TEXTURE_2D, ret.texture);<br>    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, w, h, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);<br>    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);<br>    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);<br>    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);<br>    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);<br><br>    gl.bindFramebuffer(gl.FRAMEBUFFER, ret.frameBuffer);<br>    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, ret.texture, 0);<br><br>    gl.bindRenderbuffer(gl.RENDERBUFFER, ret.renderBuffer);<br>    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, w, h);<br>    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, ret.renderBuffer);<br><br>    gl.bindTexture(gl.TEXTURE_2D, null);<br>    gl.bindRenderbuffer(gl.RENDERBUFFER, null);<br>    gl.bindFramebuffer(gl.FRAMEBUFFER, null);<br><br>    return ret;<br>}<br><br>function compileShader(shtype, shsrc) {<br>    var retsh = gl.createShader(shtype);<br><br>    gl.shaderSource(retsh, shsrc);<br>    gl.compileShader(retsh);<br><br>    if(!gl.getShaderParameter(retsh, gl.COMPILE_STATUS)) {<br>        var errlog = gl.getShaderInfoLog(retsh);<br>        gl.deleteShader(retsh);<br>        console.error(errlog);<br>        return null;<br>    }<br>    return retsh;<br>}<br><br>function createShader(vtxsrc, frgsrc, uniformlist, attrlist) {<br>    var vsh = compileShader(gl.VERTEX_SHADER, vtxsrc);<br>    var fsh = compileShader(gl.FRAGMENT_SHADER, frgsrc);<br><br>    if(vsh == null || fsh == null) {<br>        return null;<br>    }<br><br>    var prog = gl.createProgram();<br>    gl.attachShader(prog, vsh);<br>    gl.attachShader(prog, fsh);<br><br>    gl.deleteShader(vsh);<br>    gl.deleteShader(fsh);<br><br>    gl.linkProgram(prog);<br>    if (!gl.getProgramParameter(prog, gl.LINK_STATUS)) {<br>        var errlog = gl.getProgramInfoLog(prog);<br>        console.error(errlog);<br>        return null;<br>    }<br><br>    if(uniformlist) {<br>        prog.uniforms = {};<br>        for(var i = 0; i &lt; uniformlist.length; i++) {<br>            prog.uniforms[uniformlist[i]] = gl.getUniformLocation(prog, uniformlist[i]);<br>        }<br>    }<br><br>    if(attrlist) {<br>        prog.attributes = {};<br>        for(var i = 0; i &lt; attrlist.length; i++) {<br>            var attr = attrlist[i];<br>            prog.attributes[attr] = gl.getAttribLocation(prog, attr);<br>        }<br>    }<br><br>    return prog;<br>}<br><br>function useShader(prog) {<br>    gl.useProgram(prog);<br>    for(var attr in prog.attributes) {<br>        gl.enableVertexAttribArray(prog.attributes[attr]);;<br>    }<br>}<br><br>function unuseShader(prog) {<br>    for(var attr in prog.attributes) {<br>        gl.disableVertexAttribArray(prog.attributes[attr]);;<br>    }<br>    gl.useProgram(null);<br>}<br><br>/////<br>var projection = {<br>    ‘angle’:60,<br>    ‘nearfar’:new Float32Array([0.1, 100.0]),<br>    ‘matrix’:Matrix44.createIdentity()<br>};<br>var camera = {<br>    ‘position’:Vector3.create(0, 0, 100),<br>    ‘lookat’:Vector3.create(0, 0, 0),<br>    ‘up’:Vector3.create(0, 1, 0),<br>    ‘dof’:Vector3.create(10.0, 4.0, 8.0),<br>    ‘matrix’:Matrix44.createIdentity()<br>};<br><br>var pointFlower = {};<br>var meshFlower = {};<br>var sceneStandBy = false;<br><br>var BlossomParticle = function () {<br>    this.velocity = new Array(3);<br>    this.rotation = new Array(3);<br>    this.position = new Array(3);<br>    this.euler = new Array(3);<br>    this.size = 1.0;<br>    this.alpha = 1.0;<br>    this.zkey = 0.0;<br>};<br><br>BlossomParticle.prototype.setVelocity = function (vx, vy, vz) {<br>    this.velocity[0] = vx;<br>    this.velocity[1] = vy;<br>    this.velocity[2] = vz;<br>};<br><br>BlossomParticle.prototype.setRotation = function (rx, ry, rz) {<br>    this.rotation[0] = rx;<br>    this.rotation[1] = ry;<br>    this.rotation[2] = rz;<br>};<br><br>BlossomParticle.prototype.setPosition = function (nx, ny, nz) {<br>    this.position[0] = nx;<br>    this.position[1] = ny;<br>    this.position[2] = nz;<br>};<br><br>BlossomParticle.prototype.setEulerAngles = function (rx, ry, rz) {<br>    this.euler[0] = rx;<br>    this.euler[1] = ry;<br>    this.euler[2] = rz;<br>};<br><br>BlossomParticle.prototype.setSize = function (s) {<br>    this.size = s;<br>};<br><br>BlossomParticle.prototype.update = function (dt, et) {<br>    this.position[0] += this.velocity[0] </em> dt;<br>    this.position[1] += this.velocity[1] <em> dt;<br>    this.position[2] += this.velocity[2] </em> dt;<br><br>    this.euler[0] += this.rotation[0] <em> dt;<br>    this.euler[1] += this.rotation[1] </em> dt;<br>    this.euler[2] += this.rotation[2] <em> dt;<br>};<br><br>function createPointFlowers() {<br>    // get point sizes<br>    var prm = gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE);<br>    renderSpec.pointSize = {‘min’:prm[0], ‘max’:prm[1]};<br><br>    var vtxsrc = document.getElementById(“sakura_point_vsh”).textContent;<br>    var frgsrc = document.getElementById(“sakura_point_fsh”).textContent;<br><br>    pointFlower.program = createShader(<br>        vtxsrc, frgsrc,<br>        [‘uProjection’, ‘uModelview’, ‘uResolution’, ‘uOffset’, ‘uDOF’, ‘uFade’],<br>        [‘aPosition’, ‘aEuler’, ‘aMisc’]<br>    );<br><br>    useShader(pointFlower.program);<br>    pointFlower.offset = new Float32Array([0.0, 0.0, 0.0]);<br>    pointFlower.fader = Vector3.create(0.0, 10.0, 0.0);<br><br>    // paramerters: velocity[3], rotate[3]<br>    pointFlower.numFlowers = 1600;<br>    pointFlower.particles = new Array(pointFlower.numFlowers);<br>    // vertex attributes {position[3], euler_xyz[3], size[1]}<br>    pointFlower.dataArray = new Float32Array(pointFlower.numFlowers </em> (3 + 3 + 2));<br>    pointFlower.positionArrayOffset = 0;<br>    pointFlower.eulerArrayOffset = pointFlower.numFlowers <em> 3;<br>    pointFlower.miscArrayOffset = pointFlower.numFlowers </em> 6;<br><br>    pointFlower.buffer = gl.createBuffer();<br>    gl.bindBuffer(gl.ARRAY_BUFFER, pointFlower.buffer);<br>    gl.bufferData(gl.ARRAY_BUFFER, pointFlower.dataArray, gl.DYNAMIC_DRAW);<br>    gl.bindBuffer(gl.ARRAY_BUFFER, null);<br><br>    unuseShader(pointFlower.program);<br><br>    for(var i = 0; i &lt; pointFlower.numFlowers; i++) {<br>        pointFlower.particles[i] = new BlossomParticle();<br>    }<br>}<br><br>function initPointFlowers() {<br>    //area<br>    pointFlower.area = Vector3.create(20.0, 20.0, 20.0);<br>    pointFlower.area.x = pointFlower.area.y <em> renderSpec.aspect;<br><br>    pointFlower.fader.x = 10.0; //env fade start<br>    pointFlower.fader.y = pointFlower.area.z; //env fade half<br>    pointFlower.fader.z = 0.1;  //near fade start<br><br>    //particles<br>    var PI2 = Math.PI </em> 2.0;<br>    var tmpv3 = Vector3.create(0, 0, 0);<br>    var tmpv = 0;<br>    var symmetryrand = function() {return (Math.random() <em> 2.0 - 1.0);};<br>    for(var i = 0; i &lt; pointFlower.numFlowers; i++) {<br>        var tmpprtcl = pointFlower.particles[i];<br><br>        //velocity<br>        tmpv3.x = symmetryrand() </em> 0.3 + 0.8;<br>        tmpv3.y = symmetryrand() <em> 0.2 - 1.0;<br>        tmpv3.z = symmetryrand() </em> 0.3 + 0.5;<br>        Vector3.normalize(tmpv3);<br>        tmpv = 2.0 + Math.random() <em> 1.0;<br>        tmpprtcl.setVelocity(tmpv3.x </em> tmpv, tmpv3.y <em> tmpv, tmpv3.z </em> tmpv);<br><br>        //rotation<br>        tmpprtcl.setRotation(<br>            symmetryrand() <em> PI2 </em> 0.5,<br>            symmetryrand() <em> PI2 </em> 0.5,<br>            symmetryrand() <em> PI2 </em> 0.5<br>        );<br><br>        //position<br>        tmpprtcl.setPosition(<br>            symmetryrand() <em> pointFlower.area.x,<br>            symmetryrand() </em> pointFlower.area.y,<br>            symmetryrand() <em> pointFlower.area.z<br>        );<br><br>        //euler<br>        tmpprtcl.setEulerAngles(<br>            Math.random() </em> Math.PI <em> 2.0,<br>            Math.random() </em> Math.PI <em> 2.0,<br>            Math.random() </em> Math.PI <em> 2.0<br>        );<br><br>        //size<br>        tmpprtcl.setSize(0.9 + Math.random() </em> 0.1);<br>    }<br>}<br><br>function renderPointFlowers() {<br>    //update<br>    var PI2 = Math.PI <em> 2.0;<br>    var limit = [pointFlower.area.x, pointFlower.area.y, pointFlower.area.z];<br>    var repeatPos = function (prt, cmp, limit) {<br>        if(Math.abs(prt.position[cmp]) - prt.size </em> 0.5 &gt; limit) {<br>            //out of area<br>            if(prt.position[cmp] &gt; 0) {<br>                prt.position[cmp] -= limit <em> 2.0;<br>            }<br>            else {<br>                prt.position[cmp] += limit </em> 2.0;<br>            }<br>        }<br>    };<br>    var repeatEuler = function (prt, cmp) {<br>        prt.euler[cmp] = prt.euler[cmp] % PI2;<br>        if(prt.euler[cmp] &lt; 0.0) {<br>            prt.euler[cmp] += PI2;<br>        }<br>    };<br><br>    for(var i = 0; i &lt; pointFlower.numFlowers; i++) {<br>        var prtcl = pointFlower.particles[i];<br>        prtcl.update(timeInfo.delta, timeInfo.elapsed);<br>        repeatPos(prtcl, 0, pointFlower.area.x);<br>        repeatPos(prtcl, 1, pointFlower.area.y);<br>        repeatPos(prtcl, 2, pointFlower.area.z);<br>        repeatEuler(prtcl, 0);<br>        repeatEuler(prtcl, 1);<br>        repeatEuler(prtcl, 2);<br><br>        prtcl.alpha = 1.0;//(pointFlower.area.z - prtcl.position[2]) <em> 0.5;<br><br>        prtcl.zkey = (camera.matrix[2] </em> prtcl.position[0]<br>                    + camera.matrix[6] <em> prtcl.position[1]<br>                    + camera.matrix[10] </em> prtcl.position[2]<br>                    + camera.matrix[14]);<br>    }<br><br>    // sort<br>    pointFlower.particles.sort(function(p0, p1){return p0.zkey - p1.zkey;});<br><br>    // update data<br>    var ipos = pointFlower.positionArrayOffset;<br>    var ieuler = pointFlower.eulerArrayOffset;<br>    var imisc = pointFlower.miscArrayOffset;<br>    for(var i = 0; i &lt; pointFlower.numFlowers; i++) {<br>        var prtcl = pointFlower.particles[i];<br>        pointFlower.dataArray[ipos] = prtcl.position[0];<br>        pointFlower.dataArray[ipos + 1] = prtcl.position[1];<br>        pointFlower.dataArray[ipos + 2] = prtcl.position[2];<br>        ipos += 3;<br>        pointFlower.dataArray[ieuler] = prtcl.euler[0];<br>        pointFlower.dataArray[ieuler + 1] = prtcl.euler[1];<br>        pointFlower.dataArray[ieuler + 2] = prtcl.euler[2];<br>        ieuler += 3;<br>        pointFlower.dataArray[imisc] = prtcl.size;<br>        pointFlower.dataArray[imisc + 1] = prtcl.alpha;<br>        imisc += 2;<br>    }<br><br>    //draw<br>    gl.enable(gl.BLEND);<br>    //gl.disable(gl.DEPTH_TEST);<br>    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);<br><br>    var prog = pointFlower.program;<br>    useShader(prog);<br><br>    gl.uniformMatrix4fv(prog.uniforms.uProjection, false, projection.matrix);<br>    gl.uniformMatrix4fv(prog.uniforms.uModelview, false, camera.matrix);<br>    gl.uniform3fv(prog.uniforms.uResolution, renderSpec.array);<br>    gl.uniform3fv(prog.uniforms.uDOF, Vector3.arrayForm(camera.dof));<br>    gl.uniform3fv(prog.uniforms.uFade, Vector3.arrayForm(pointFlower.fader));<br><br>    gl.bindBuffer(gl.ARRAY_BUFFER, pointFlower.buffer);<br>    gl.bufferData(gl.ARRAY_BUFFER, pointFlower.dataArray, gl.DYNAMIC_DRAW);<br><br>    gl.vertexAttribPointer(prog.attributes.aPosition, 3, gl.FLOAT, false, 0, pointFlower.positionArrayOffset <em> Float32Array.BYTES_PER_ELEMENT);<br>    gl.vertexAttribPointer(prog.attributes.aEuler, 3, gl.FLOAT, false, 0, pointFlower.eulerArrayOffset </em> Float32Array.BYTES_PER_ELEMENT);<br>    gl.vertexAttribPointer(prog.attributes.aMisc, 2, gl.FLOAT, false, 0, pointFlower.miscArrayOffset <em> Float32Array.BYTES_PER_ELEMENT);<br><br>    // doubler<br>    for(var i = 1; i &lt; 2; i++) {<br>        var zpos = i </em> -2.0;<br>        pointFlower.offset[0] = pointFlower.area.x <em> -1.0;<br>        pointFlower.offset[1] = pointFlower.area.y </em> -1.0;<br>        pointFlower.offset[2] = pointFlower.area.z <em> zpos;<br>        gl.uniform3fv(prog.uniforms.uOffset, pointFlower.offset);<br>        gl.drawArrays(gl.POINT, 0, pointFlower.numFlowers);<br><br>        pointFlower.offset[0] = pointFlower.area.x </em> -1.0;<br>        pointFlower.offset[1] = pointFlower.area.y <em>  1.0;<br>        pointFlower.offset[2] = pointFlower.area.z </em> zpos;<br>        gl.uniform3fv(prog.uniforms.uOffset, pointFlower.offset);<br>        gl.drawArrays(gl.POINT, 0, pointFlower.numFlowers);<br><br>        pointFlower.offset[0] = pointFlower.area.x <em>  1.0;<br>        pointFlower.offset[1] = pointFlower.area.y </em> -1.0;<br>        pointFlower.offset[2] = pointFlower.area.z <em> zpos;<br>        gl.uniform3fv(prog.uniforms.uOffset, pointFlower.offset);<br>        gl.drawArrays(gl.POINT, 0, pointFlower.numFlowers);<br><br>        pointFlower.offset[0] = pointFlower.area.x </em>  1.0;<br>        pointFlower.offset[1] = pointFlower.area.y <em>  1.0;<br>        pointFlower.offset[2] = pointFlower.area.z </em> zpos;<br>        gl.uniform3fv(prog.uniforms.uOffset, pointFlower.offset);<br>        gl.drawArrays(gl.POINT, 0, pointFlower.numFlowers);<br>    }<br><br>    //main<br>    pointFlower.offset[0] = 0.0;<br>    pointFlower.offset[1] = 0.0;<br>    pointFlower.offset[2] = 0.0;<br>    gl.uniform3fv(prog.uniforms.uOffset, pointFlower.offset);<br>    gl.drawArrays(gl.POINT, 0, pointFlower.numFlowers);<br><br>    gl.bindBuffer(gl.ARRAY_BUFFER, null);<br>    unuseShader(prog);<br><br>    gl.enable(gl.DEPTH_TEST);<br>    gl.disable(gl.BLEND);<br>}<br><br>// effects<br>//common util<br>function createEffectProgram(vtxsrc, frgsrc, exunifs, exattrs) {<br>    var ret = {};<br>    var unifs = [‘uResolution’, ‘uSrc’, ‘uDelta’];<br>    if(exunifs) {<br>        unifs = unifs.concat(exunifs);<br>    }<br>    var attrs = [‘aPosition’];<br>    if(exattrs) {<br>        attrs = attrs.concat(exattrs);<br>    }<br><br>    ret.program = createShader(vtxsrc, frgsrc, unifs, attrs);<br>    useShader(ret.program);<br><br>    ret.dataArray = new Float32Array([<br>        -1.0, -1.0,<br>         1.0, -1.0,<br>        -1.0,  1.0,<br>         1.0,  1.0<br>    ]);<br>    ret.buffer = gl.createBuffer();<br>    gl.bindBuffer(gl.ARRAY_BUFFER, ret.buffer);<br>    gl.bufferData(gl.ARRAY_BUFFER, ret.dataArray, gl.STATIC_DRAW);<br><br>    gl.bindBuffer(gl.ARRAY_BUFFER, null);<br>    unuseShader(ret.program);<br><br>    return ret;<br>}<br><br>// basic usage<br>// useEffect(prog, srctex({‘texture’:texid, ‘dtxArray’:(f32)[dtx, dty]})); //basic initialize<br>// gl.uniform*<em>(…); //additional uniforms<br>// drawEffect()<br>// unuseEffect(prog)<br>// TEXTURE0 makes src<br>function useEffect(fxobj, srctex) {<br>    var prog = fxobj.program;<br>    useShader(prog);<br>    gl.uniform3fv(prog.uniforms.uResolution, renderSpec.array);<br><br>    if(srctex != null) {<br>        gl.uniform2fv(prog.uniforms.uDelta, srctex.dtxArray);<br>        gl.uniform1i(prog.uniforms.uSrc, 0);<br><br>        gl.activeTexture(gl.TEXTURE0);<br>        gl.bindTexture(gl.TEXTURE_2D, srctex.texture);<br>    }<br>}<br>function drawEffect(fxobj) {<br>    gl.bindBuffer(gl.ARRAY_BUFFER, fxobj.buffer);<br>    gl.vertexAttribPointer(fxobj.program.attributes.aPosition, 2, gl.FLOAT, false, 0, 0);<br>    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);<br>}<br>function unuseEffect(fxobj) {<br>    unuseShader(fxobj.program);<br>}<br><br>var effectLib = {};<br>function createEffectLib() {<br><br>    var vtxsrc, frgsrc;<br>    //common<br>    var cmnvtxsrc = document.getElementById(“fx_common_vsh”).textContent;<br><br>    //background<br>    frgsrc = document.getElementById(“bg_fsh”).textContent;<br>    effectLib.sceneBg = createEffectProgram(cmnvtxsrc, frgsrc, [‘uTimes’], null);<br><br>    // make brightpixels buffer<br>    frgsrc = document.getElementById(“fx_brightbuf_fsh”).textContent;<br>    effectLib.mkBrightBuf = createEffectProgram(cmnvtxsrc, frgsrc, null, null);<br><br>    // direction blur<br>    frgsrc = document.getElementById(“fx_dirblur_r4_fsh”).textContent;<br>    effectLib.dirBlur = createEffectProgram(cmnvtxsrc, frgsrc, [‘uBlurDir’], null);<br><br>    //final composite<br>    vtxsrc = document.getElementById(“pp_final_vsh”).textContent;<br>    frgsrc = document.getElementById(“pp_final_fsh”).textContent;<br>    effectLib.finalComp = createEffectProgram(vtxsrc, frgsrc, [‘uBloom’], null);<br>}<br><br>// background<br>function createBackground() {<br>    //console.log(“create background”);<br>}<br>function initBackground() {<br>    //console.log(“init background”);<br>}<br>function renderBackground() {<br>    gl.disable(gl.DEPTH_TEST);<br><br>    useEffect(effectLib.sceneBg, null);<br>    gl.uniform2f(effectLib.sceneBg.program.uniforms.uTimes, timeInfo.elapsed, timeInfo.delta);<br>    drawEffect(effectLib.sceneBg);<br>    unuseEffect(effectLib.sceneBg);<br><br>    gl.enable(gl.DEPTH_TEST);<br>}<br><br>// post process<br>var postProcess = {};<br>function createPostProcess() {<br>    //console.log(“create post process”);<br>}<br>function initPostProcess() {<br>    //console.log(“init post process”);<br>}<br><br>function renderPostProcess() {<br>    gl.enable(gl.TEXTURE_2D);<br>    gl.disable(gl.DEPTH_TEST);<br>    var bindRT = function (rt, isclear) {<br>        gl.bindFramebuffer(gl.FRAMEBUFFER, rt.frameBuffer);<br>        gl.viewport(0, 0, rt.width, rt.height);<br>        if(isclear) {<br>            gl.clearColor(0, 0, 0, 0);<br>            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);<br>        }<br>    };<br><br>    //make bright buff<br>    bindRT(renderSpec.wHalfRT0, true);<br>    useEffect(effectLib.mkBrightBuf, renderSpec.mainRT);<br>    drawEffect(effectLib.mkBrightBuf);<br>    unuseEffect(effectLib.mkBrightBuf);<br><br>    // make bloom<br>    for(var i = 0; i &lt; 2; i++) {<br>        var p = 1.5 + 1 </em> i;<br>        var s = 2.0 + 1 <em> i;<br>        bindRT(renderSpec.wHalfRT1, true);<br>        useEffect(effectLib.dirBlur, renderSpec.wHalfRT0);<br>        gl.uniform4f(effectLib.dirBlur.program.uniforms.uBlurDir, p, 0.0, s, 0.0);<br>        drawEffect(effectLib.dirBlur);<br>        unuseEffect(effectLib.dirBlur);<br><br>        bindRT(renderSpec.wHalfRT0, true);<br>        useEffect(effectLib.dirBlur, renderSpec.wHalfRT1);<br>        gl.uniform4f(effectLib.dirBlur.program.uniforms.uBlurDir, 0.0, p, 0.0, s);<br>        drawEffect(effectLib.dirBlur);<br>        unuseEffect(effectLib.dirBlur);<br>    }<br><br>    //display<br>    gl.bindFramebuffer(gl.FRAMEBUFFER, null);<br>    gl.viewport(0, 0, renderSpec.width, renderSpec.height);<br>    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);<br><br>    useEffect(effectLib.finalComp, renderSpec.mainRT);<br>    gl.uniform1i(effectLib.finalComp.program.uniforms.uBloom, 1);<br>    gl.activeTexture(gl.TEXTURE1);<br>    gl.bindTexture(gl.TEXTURE_2D, renderSpec.wHalfRT0.texture);<br>    drawEffect(effectLib.finalComp);<br>    unuseEffect(effectLib.finalComp);<br><br>    gl.enable(gl.DEPTH_TEST);<br>}<br><br>/////<br>var SceneEnv = {};<br>function createScene() {<br>    createEffectLib();<br>    createBackground();<br>    createPointFlowers();<br>    createPostProcess();<br>    sceneStandBy = true;<br>}<br><br>function initScene() {<br>    initBackground();<br>    initPointFlowers();<br>    initPostProcess();<br><br>    //camera.position.z = 17.320508;<br>    camera.position.z = pointFlower.area.z + projection.nearfar[0];<br>    projection.angle = Math.atan2(pointFlower.area.y, camera.position.z + pointFlower.area.z) </em> 180.0 / Math.PI * 2.0;<br>    Matrix44.loadProjection(projection.matrix, renderSpec.aspect, projection.angle, projection.nearfar[0], projection.nearfar[1]);<br>}<br><br>function renderScene() {<br>    //draw<br>    Matrix44.loadLookAt(camera.matrix, camera.position, camera.lookat, camera.up);<br><br>    gl.enable(gl.DEPTH_TEST);<br><br>    //gl.bindFramebuffer(gl.FRAMEBUFFER, null);<br>    gl.bindFramebuffer(gl.FRAMEBUFFER, renderSpec.mainRT.frameBuffer);<br>    gl.viewport(0, 0, renderSpec.mainRT.width, renderSpec.mainRT.height);<br>    gl.clearColor(0.005, 0, 0.05, 0);<br>    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);<br><br>    renderBackground();<br>    renderPointFlowers();<br>    renderPostProcess();<br>}<br><br>/////<br>function onResize(e) {<br>    makeCanvasFullScreen(document.getElementById(“sakura”));<br>    setViewports();<br>    if(sceneStandBy) {<br>        initScene();<br>    }<br>}<br><br>function setViewports() {<br>    renderSpec.setSize(gl.canvas.width, gl.canvas.height);<br><br>    gl.clearColor(0.2, 0.2, 0.5, 1.0);<br>    gl.viewport(0, 0, renderSpec.width, renderSpec.height);<br><br>    var rtfunc = function (rtname, rtw, rth) {<br>        var rt = renderSpec[rtname];<br>        if(rt) deleteRenderTarget(rt);<br>        renderSpec[rtname] = createRenderTarget(rtw, rth);<br>    };<br>    rtfunc(‘mainRT’, renderSpec.width, renderSpec.height);<br>    rtfunc(‘wFullRT0’, renderSpec.width, renderSpec.height);<br>    rtfunc(‘wFullRT1’, renderSpec.width, renderSpec.height);<br>    rtfunc(‘wHalfRT0’, renderSpec.halfWidth, renderSpec.halfHeight);<br>    rtfunc(‘wHalfRT1’, renderSpec.halfWidth, renderSpec.halfHeight);<br>}<br><br>function render() {<br>    renderScene();<br>}<br><br>var animating = true;<br>function toggleAnimation(elm) {<br>    animating ^= true;<br>    if(animating) animate();<br>    if(elm) {<br>        elm.innerHTML = animating? “Stop”:”Start”;<br>    }<br>}<br><br>function stepAnimation() {<br>    if(!animating) animate();<br>}<br><br>function animate() {<br>    var curdate = new Date();<br>    timeInfo.elapsed = (curdate - timeInfo.start) / 1000.0;<br>    timeInfo.delta = (curdate - timeInfo.prev) / 1000.0;<br>    timeInfo.prev = curdate;<br><br>    if(animating) requestAnimationFrame(animate);<br>    render();<br>}<br><br>function makeCanvasFullScreen(canvas) {<br>    var b = document.body;<br>    var d = document.documentElement;<br>    fullw = Math.max(b.clientWidth , b.scrollWidth, d.scrollWidth, d.clientWidth);<br>    fullh = Math.max(b.clientHeight , b.scrollHeight, d.scrollHeight, d.clientHeight);<br>    canvas.width = fullw;<br>    canvas.height = fullh;<br>}<br><br>window.addEventListener(‘load’, function(e) {<br>    var canvas = document.getElementById(“sakura”);<br>    try {<br>        makeCanvasFullScreen(canvas);<br>        gl = canvas.getContext(‘experimental-webgl’);<br>    } catch(e) {<br>        alert(“WebGL not supported.” + e);<br>        console.error(e);<br>        return;<br>    }<br><br>    window.addEventListener(‘resize’, onResize);<br><br>    setViewports();<br>    createScene();<br>    initScene();<br><br>    timeInfo.start = new Date();<br>    timeInfo.prev = timeInfo.start;<br>    animate();<br>});<br><br>//set window.requestAnimationFrame<br>(function (w, r) {<br>    w[‘r’+r] = w[‘r’+r] || w[‘webkitR’+r] || w[‘mozR’+r] || w[‘msR’+r] || w[‘oR’+r] || function(c){ w.setTimeout(c, 1000 / 60); };<br>})(window, ‘equestAnimationFrame’);<br></script><br><script type="text/javascript"><br>    (function(){<br>      var animenuToggle = document.querySelector(‘.animenu__toggle’),<br>          animenuNav    = document.querySelector(‘.animenu__nav’),<br>          hasClass = function( elem, className ) {<br>            return new RegExp( ‘ ‘ + className + ‘ ‘ ).test( ‘ ‘ + elem.className + ‘ ‘ );<br>          },<br>          toggleClass = function( elem, className ) {<br>            var newClass = ‘ ‘ + elem.className.replace( /[\t\r\n]/g, ‘ ‘ ) + ‘ ‘;<br>            if( hasClass(elem, className ) ) {<br>              while( newClass.indexOf( ‘ ‘ + className + ‘ ‘ ) &gt;= 0 ) {<br>                newClass = newClass.replace( ‘ ‘ + className + ‘ ‘ , ‘ ‘ );<br>              }<br>              elem.className = newClass.replace( /^\s+|\s+$/g, ‘’ );<br>            } else {<br>              elem.className += ‘ ‘ + className;<br>            }<br>          },<br>          animenuToggleNav =  function (){<br>            toggleClass(animenuToggle, “animenu__toggle–active”);<br>            toggleClass(animenuNav, “animenu__nav–open”);<br>          }<br><br>      if (!animenuToggle.addEventListener) {<br>          animenuToggle.attachEvent(“onclick”, animenuToggleNav);<br>      }<br>      else {<br>          animenuToggle.addEventListener(‘click’, animenuToggleNav);<br>      }<br>    })()<br></script><br></html>

